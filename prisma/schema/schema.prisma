generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

model Schedule {
    id        String   @id @default(uuid())
    startTime DateTime
    endTime   DateTime
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    doctorSchedules DoctorSchedules[]

    @@map("schedules")
}

model DoctorSchedules {
    doctorId   String
    doctor     Doctor   @relation(fields: [doctorId], references: [id])
    scheduleId String
    schedule   Schedule @relation(fields: [scheduleId], references: [id])
    isBooked   Boolean  @default(true)
    createdAt  DateTime @default(now())
    updatedAt  DateTime @updatedAt

    @@id([doctorId, scheduleId])
    @@map("doctor_schedules")
}


model User {
    id                 String     @id @default(uuid())
    email              String     @unique
    password           String
    role               UserRole   @default(PATIENT)
    needPasswordChange Boolean    @default(true)
    status             UserStatus @default(ACTIVE)
    createdAt          DateTime   @default(now())
    updatedAt          DateTime   @updatedAt
    admin              Admin?
    doctor             Doctor?
    patient            Patient?

    @@map("users")
}

model Admin {
    id            String   @id @default(uuid())
    name          String
    email         String   @unique
    profilePhoto  String?
    contactNumber String
    isDeleted     Boolean  @default(false)
    createdAt     DateTime @default(now())
    updatedAt     DateTime @updatedAt

    user User @relation(fields: [email], references: [email])

    @@map("admins")
}

model Doctor {
    id                  String   @id @default(uuid())
    name                String
    email               String   @unique
    profilePhoto        String?
    contactNumber       String
    address             String?
    registrationNumber  String
    experience          Int      @default(0)
    gender              Gender
    appointmentFee      Int
    qualification       String
    currentWorkingPlace String
    designation         String
    isDeleted           Boolean  @default(false)
    createdAt           DateTime @default(now())
    updatedAt           DateTime @updatedAt

    doctorSchedules DoctorSchedules[]

    user User @relation(fields: [email], references: [email])

    @@map("doctors")
}

model Patient {
    id           String   @id @default(uuid())
    email        String   @unique
    name         String
    profilePhoto String?
    address      String?
    isDeleted    Boolean  @default(false)
    createdAt    DateTime @default(now())
    updatedAt    DateTime @updatedAt

    user User @relation(fields: [email], references: [email])

    @@map("patients")
}

enum UserRole {
    PATIENT
    DOCTOR
    ADMIN
}

enum UserStatus {
    ACTIVE
    INACTIVE
    DELETED
}

enum Gender {
    MALE
    FEMALE
}
